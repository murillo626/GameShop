<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:sec="http://thymeleaf.org/extras/spring-security">
    <head th:replace="layout/Plantilla :: head">
        <title>TechShop</title>        
    </head>
    <body>        

        <section th:fragment="listadoArticulos" id="articulo">
        <div class="container">
            <div class="row row-cols-2">
                <h2 class="inline" th:text="#{index.titulo}">Nuestros Articulos</h2>
                <div id="resultsBlock">
                    
                </div>
            </div>
            <div class="row row-cols-3">
                <div class="card" th:each="articulo : ${articulos}" th:if="${articulo.id_Categoria==1}">
                    <div class="card-body">
                        <h5 class="card-title">[[${articulo.descripcion}]]</h5>
                         <figure>
                            <img th:src="@{${articulo.ruta}}" width="120"/>
                            <figcaption>
                                [[${new java.text.DecimalFormat('¢#,##0.00').format(articulo.precio)+'('+articulo.existencias+')'}]]
                            </figcaption>
                        </figure>
                        <form>
                            <input type="hidden" name="texto" th:value="${articulo.id_Articulo}"/>
                            <input type="hidden" name="texto" th:value="${articulo.existencias}"/>
                            <button class="btn btn-ligth"
                                    id="addCar"
                                    name="addCar"
                                    onclick="addCard(this.form)"
                                    type="button">
                                <i class="fas fa-cart-plus"></i>
                            </button>
                        </form>
                        <p class="card-text">[[${articulo.detalle}]]</p>
                    </div>
                </div>
            </div>
            </div>
        </section>
          
        <section th:fragment="listadoArticulosx" id="articulo">
        <div class="container">
            <div class="row row-cols-2">
                <h2 class="inline" th:text="#{index.titulo}">Nuestros Articulos</h2>
                <div id="resultBlock">
                    
                </div>
            </div>
            <div class="row row-cols-3">
                <div class="card" th:each="articulo : ${articulos}" th:if="${articulo.id_Categoria==2}">
                    <div class="card-body">
                        <h5 class="card-title">[[${articulo.descripcion}]]</h5>
                         <figure>
                            <img th:src="@{${articulo.ruta}}" width="120"/>
                            <figcaption>
                                [[${new java.text.DecimalFormat('¢#,##0.00').format(articulo.precio)+'('+articulo.existencias+')'}]]
                            </figcaption>
                        </figure>
                        <form>
                            <input type="hidden" name="texto" th:value="${articulo.id_Articulo}"/>
                            <input type="hidden" name="texto" th:value="${articulo.existencias}"/>
                            <button class="btn btn-ligth"
                                    id="addCar"
                                    name="addCar"
                                    onclick="addCard(this.form)"
                                    type="button">
                                <i class="fas fa-cart-plus"></i>
                            </button>
                        </form>
                        <p class="card-text">[[${articulo.detalle}]]</p>
                    </div>
                </div>
            </div>
            </div>
        </section>
        
        <section th:fragment="listadoArticulosn" id="articulo">
        <div class="container">
            <div class="row row-cols-2">
                <h2 class="inline" th:text="#{index.titulo}">Nuestros Articulos</h2>
                <div id="resultBlock">
                    
                </div>
            </div>
            <div class="row row-cols-3">
                <div class="card" th:each="articulo : ${articulos}" th:if="${articulo.id_Categoria==3}">
                    <div class="card-body">
                        <h5 class="card-title">[[${articulo.descripcion}]]</h5>
                         <figure>
                            <img th:src="@{${articulo.ruta}}" width="120"/>
                            <figcaption>
                                [[${new java.text.DecimalFormat('¢#,##0.00').format(articulo.precio)+'('+articulo.existencias+')'}]]
                            </figcaption>
                        </figure>
                        <form>
                            <input type="hidden" name="texto" th:value="${articulo.id_Articulo}"/>
                            <input type="hidden" name="texto" th:value="${articulo.existencias}"/>
                            <button class="btn btn-ligth"
                                    id="addCar"
                                    name="addCar"
                                    onclick="addCard(this.form)"
                                    type="button">
                                <i class="fas fa-cart-plus"></i>
                            </button>
                        </form>
                        <p class="card-text">[[${articulo.detalle}]]</p>
                    </div>
                </div>
            </div>
            </div>
        </section>
        
        <section th:fragment="listadoArticulosm" id="articulo">
        <div class="container">
            <div class="row row-cols-2">
                <h2 class="inline" th:text="#{index.titulo}">Nuestros Articulos</h2>
                <div id="resultBlock">
                    
                </div>
            </div>
            <div class="row row-cols-3">
                <div class="card" th:each="articulo : ${articulos}" th:if="${articulo.id_Categoria==4}">
                    <div class="card-body">
                        <h5 class="card-title">[[${articulo.descripcion}]]</h5>
                         <figure>
                            <img th:src="@{${articulo.ruta}}" width="120"/>
                            <figcaption>
                                [[${new java.text.DecimalFormat('¢#,##0.00').format(articulo.precio)+'('+articulo.existencias+')'}]]
                            </figcaption>
                        </figure>
                        <form>
                            <input type="hidden" name="texto" th:value="${articulo.id_Articulo}"/>
                            <input type="hidden" name="texto" th:value="${articulo.existencias}"/>
                            <button class="btn btn-ligth"
                                    id="addCar"
                                    name="addCar"
                                    onclick="addCard(this.form)"
                                    type="button">
                                <i class="fas fa-cart-plus"></i>
                            </button>
                        </form>
                        <p class="card-text">[[${articulo.detalle}]]</p>
                    </div>
                </div>
            </div>
            </div>
        </section>
        
        <div th:fragment="verCarrito" th:unless="${#lists.isEmpty(listaItems)}">
            <form action="/carrito/listado">
                <button
                    type="submit"
                    class="btn gbtn-primary">
                    <i class="fas fa-cart-plus"></i>[[#{carrito.verCarrito}]] [[${listaTotal}]]
                </button> 
            </form>
        </div>
        
        <section th:fragment="listadoCarrito" id="carrito">
            <div class="container">
                <div class="row">
                    <div class="col-md-9">
                        <div class="card">
                            <div class="card-header">
                                <h4>[[#{carrito.titulo}]]</h4>
                            </div>
                                <div th:if="${items != null and !items.empty}">
                                    <table class="table table-striped">
                                        <thead class="thead-dark">
                                            <tr>
                                                <th>#</th>
                                                <th>[[#{articulo.descripcion}]]</th>
                                                <th>[[#{articulo.precio}]]</th>
                                                <th>[[#{articulo.cantidad}]]</th>
                                                <th>[[#{articulo.total}]]</th>
                                                <th></th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="item, contador : ${items}">
                                                <td>[[${contador.count}]]</td>
                                                <td>[[${item.descripcion}]]</td>
                                                <td class='text-end'>[[${new java.text.DecimalFormat('$#,##0.00').format(item.credito.precio)}]]</td>
                                                <td class='text-center'>[[${new java.text.DecimalFormat('#,###.##0').format(item.credito.cantidad)}]]</td>
                                                <td class='text-center'>[[${new java.text.DecimalFormat('$#,###.##0.00').format(item.credito.cantidad*item.precio)}]]</td>
                                                <td>    
                                                    <a th:href="@{/carrito/eliminar/} + ${item.id_Articulo}" 
                                                       class="btn btn-danger">
                                                        <i class='fas fa-trash'></i> [[#{accion.eliminar}]]
                                                    </a>
                                                </td>
                                                <td>
                                                    <a th:href="@{/carrito/modificar/} + ${item.id_Articulo}" 
                                                       class='btn btn-success'>
                                                        <i class='fas fa-pencil'></i> [[#{accion.actualizar}]]
                                                    </a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="text-center p-2" th:if="${items == null or items.empty}">
                                    <span th:text="#{articulo.no_mostrar}">Lista vacia</span>
                                </div>
                            </div>
                        </div>
                    <div class="col-md-3">
                        <div class="card text-center bg-primary text-white mb-3">
                            <div class="card-body">
                                <h3>[[#{carrito.totalCompra}]]</h3>
                                <h4 class="fs-4">
                                    [[${new java.text.DecimalFormat('$#,##0.00').format(carritoTotal)}]]
                                </h4>
                            </div>
                        </div>
                        <div class="card  text-center bg-success text-white mb-3">
                            <div class="card-body">
                                <a th:href="@{/}"
                                    class="btn btn-success">
                                    <i class="fas fa-users"></i> [[${carrito.seguirComprando}]]
                                </a>
                            </div>
                        </div>
                        <div class="card  text-center bg-success text-white mb-3">
                            <div class="card-body">
                                <a th:href="@{/facturar/carrito}"
                                    class="btn btn-success">
                                    <i class="fas fa-fordward"></i> [[${carrito.facturar}]]
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>            
        </section>
        
        
    </body>
</html>